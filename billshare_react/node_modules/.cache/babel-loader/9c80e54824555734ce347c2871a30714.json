{"ast":null,"code":"import Stomp from \"stompjs\";\nimport SockJS from \"sockjs-client\";\nimport jQuery from \"jquery\";\nvar stompClient = null; // const IP = '192.168.0.125'\n\nconst IP = '192.168.86.166'; // const IP = 'localhost'\n\nfunction setConnected(connected) {\n  jQuery(\"#connect\").prop(\"disabled\", connected);\n  jQuery(\"#disconnect\").prop(\"disabled\", !connected);\n\n  if (connected) {\n    jQuery(\"#conversation\").show();\n  } else {\n    jQuery(\"#conversation\").hide();\n  }\n\n  jQuery(\"#greetings\").html(\"\");\n} // const token =  \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0MkB0ZXN0LmNvbSIsImV4cCI6MTY1ODYxODAwMywiaWF0IjoxNjU4MDEzMjAzfQ.cKY9MXJTpw9OOzSvVDEynrLw9VSAUohhrCxrYE1Wn5aJjqlIk1nzt1IzhWIJleTFN5-2WeabHmVic3z4WP9GhQ\"\n\n\nconst token = \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwiZXhwIjoxNjU4NDQ0NjYzLCJpYXQiOjE2NTc4Mzk4NjN9.CCduvnBjvq9vXkbifwYC-bgB1XYtoW7GIdtvzp_ZSfyfgwImB-V6_6ymGVFHdO6NHjaqocW6E1Bsrh5iYOwCjw\";\n\nfunction connect() {\n  var socket = new SockJS(`http://${IP}:8080/gs-guide-websocket`, null, {\n    transports: ['xhr-streaming'],\n    headers: {\n      'Authorization': token\n    }\n  });\n  stompClient = Stomp.over(socket);\n  stompClient.connect({\n    \"Authorization\": token\n  }, function (frame) {\n    setConnected(true);\n    console.log('Connected: ' + frame);\n    stompClient.subscribe('/topic/greetings', function (greeting) {\n      showGreeting(JSON.parse(greeting.body).content);\n    });\n    stompClient.subscribe('/user/topic/private-greetings', function (greeting) {\n      showGreeting(JSON.parse(greeting.body).content); // showGreeting(JSON.parse(greeting.body));\n\n      showGreeting(greeting.body);\n    });\n  });\n}\n\nfunction disconnect() {\n  if (stompClient !== null) {\n    stompClient.disconnect();\n  }\n\n  setConnected(false);\n  console.log(\"Disconnected\");\n}\n\nfunction sendName() {\n  console.log(\"call send name\");\n  stompClient.send(\"/app/hello\", {}, JSON.stringify({\n    'name': jQuery(\"#name\").val()\n  })); //     stompClient.send(\"/topic/greetings\", {}, JSON.stringify({'name': jQuery(\"#name\").val()}));\n}\n\nfunction sendPrivateName() {\n  stompClient.send(\"/app/private-hello\", {}, JSON.stringify({\n    'name': jQuery(\"#private-name\").val()\n  }));\n}\n\nfunction showGreeting(message) {\n  console.log(\"ggggggggg\");\n  jQuery(\"#greetings\").append(\"<tr><td>\" + message + \"</td></tr>\");\n}\n\njQuery(function () {\n  jQuery(\"form\").on('submit', function (e) {\n    e.preventDefault();\n  });\n  jQuery(\"#connect\").click(function () {\n    connect();\n  });\n  jQuery(\"#disconnect\").click(function () {\n    disconnect();\n  });\n  jQuery(\"#send\").click(function () {\n    sendName();\n  });\n  jQuery(\"#send-private\").click(function () {\n    sendPrivateName();\n  });\n});","map":{"version":3,"sources":["/Users/yuning/Documents/GitHub/BillShare/billshare_react/src/api/TestWebSocket/app.js"],"names":["Stomp","SockJS","jQuery","stompClient","IP","setConnected","connected","prop","show","hide","html","token","connect","socket","transports","headers","over","frame","console","log","subscribe","greeting","showGreeting","JSON","parse","body","content","disconnect","sendName","send","stringify","val","sendPrivateName","message","append","on","e","preventDefault","click"],"mappings":"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","sourcesContent":["import Stomp from \"stompjs\";\nimport SockJS from \"sockjs-client\";\nimport jQuery from \"jquery\";\n\n\nvar stompClient = null;\n// const IP = '192.168.0.125'\nconst IP = '192.168.86.166'\n// const IP = 'localhost'\n\nfunction setConnected(connected) {\n    jQuery(\"#connect\").prop(\"disabled\", connected);\n    jQuery(\"#disconnect\").prop(\"disabled\", !connected);\n    if (connected) {\n        jQuery(\"#conversation\").show();\n    }\n    else {\n        jQuery(\"#conversation\").hide();\n    }\n    jQuery(\"#greetings\").html(\"\");\n}\n// const token =  \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0MkB0ZXN0LmNvbSIsImV4cCI6MTY1ODYxODAwMywiaWF0IjoxNjU4MDEzMjAzfQ.cKY9MXJTpw9OOzSvVDEynrLw9VSAUohhrCxrYE1Wn5aJjqlIk1nzt1IzhWIJleTFN5-2WeabHmVic3z4WP9GhQ\"\nconst token =  \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwiZXhwIjoxNjU4NDQ0NjYzLCJpYXQiOjE2NTc4Mzk4NjN9.CCduvnBjvq9vXkbifwYC-bgB1XYtoW7GIdtvzp_ZSfyfgwImB-V6_6ymGVFHdO6NHjaqocW6E1Bsrh5iYOwCjw\"\nfunction connect() {\n    var socket = new SockJS(`http://${IP}:8080/gs-guide-websocket`,\n    null,\n   {\n       transports: ['xhr-streaming'], \n       headers: {'Authorization': token }\n   });\n\n    stompClient = Stomp.over(socket);\n    stompClient.connect({\"Authorization\":token}, function (frame) {\n        setConnected(true);\n        console.log('Connected: ' + frame);\n        stompClient.subscribe('/topic/greetings', function (greeting) {\n            showGreeting(JSON.parse(greeting.body).content);\n        });\n        stompClient.subscribe('/user/topic/private-greetings', function (greeting) {\n            showGreeting(JSON.parse(greeting.body).content);\n            // showGreeting(JSON.parse(greeting.body));\n            showGreeting(greeting.body);\n        });\n    });\n}\n\nfunction disconnect() {\n    if (stompClient !== null) {\n        stompClient.disconnect();\n    }\n    setConnected(false);\n    console.log(\"Disconnected\");\n}\n\nfunction sendName() {\n    console.log(\"call send name\")\n    stompClient.send(\"/app/hello\", {}, JSON.stringify({'name': jQuery(\"#name\").val()}));\n    //     stompClient.send(\"/topic/greetings\", {}, JSON.stringify({'name': jQuery(\"#name\").val()}));\n\n}\n\nfunction sendPrivateName() {\n    stompClient.send(\"/app/private-hello\", {}, JSON.stringify({'name': jQuery(\"#private-name\").val()}));\n}\n\nfunction showGreeting(message) {\n    console.log(\"ggggggggg\")\n    jQuery(\"#greetings\").append(\"<tr><td>\" + message + \"</td></tr>\");\n}\n\njQuery(function () {\n    jQuery(\"form\").on('submit', function (e) {\n        e.preventDefault();\n    });\n    jQuery( \"#connect\" ).click(function() { connect(); });\n    jQuery( \"#disconnect\" ).click(function() { disconnect(); });\n    jQuery( \"#send\" ).click(function() { sendName(); });\n    jQuery( \"#send-private\" ).click(function() { sendPrivateName(); });\n});"]},"metadata":{},"sourceType":"module"}